<!DOCTYPE>
<html ng-app="myApp">
<head>

 <title>DailyClosingStock</title>

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<!-- <script src="stockcntrl.js"></script> -->
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.5/jspdf.min.js"></script>

<script type="text/javascript">
    $(document).ready(function(){
        var specialElementHandlers = {
            '#editor': function (element,renderer) {
                return true;
            }
        };
        $('#cmd').click(function () {
            var doc = new jsPDF( "landscape","pt","legal");
            // doc.autoTable(columns, rows);
            var dt = new Date();
            var day = dt.getDate();
            var month = dt.getMonth() + 1;
            var year = dt.getFullYear();
    // var hour = dt.getHours();
    // var mins = dt.getMinutes();
           var postfix = day + "." + month + "." + year;
            var source = $('#target').html();
            var specialElementHandlers = {
                '#bypassme': function (element, renderer) {
                    return true;
                }
                
            };
            doc.fromHTML(source, 0, 0, {
                              width: '100%',
                'elementHandlers': specialElementHandlers
              // }
            });
             doc.save('DailyStock'+postfix+'.pdf');
        });
    });
</script>
<script type="text/javascript">
$(document).ready(function() {
    $("#btnExport").click(function(e) {
        var dt = new Date();
        var day = dt.getDate();
        var month = dt.getMonth() + 1;
        var year = dt.getFullYear();
        // var hour = dt.getHours();
        // var mins = dt.getMinutes();
        var postfix = day + "." + month + "." + year;
        var a = document.createElement('a');
        var data_type = 'data:application/vnd.ms-excel';
        var table_div = document.getElementById('target');
        var table_html = table_div.outerHTML.replace(/ /g, '%20');
        a.href = data_type + ', ' + table_html;
        a.download = 'DailyStock-' + postfix + '.xls';
        a.click();
        e.preventDefault();
    });
});
</script>
 </head> 

 <style type="text/css">
 .center {
    margin:auto;
    width: 30%;
    
    
}
   .selectpic {
   /* margin:auto;*/
    width: 230%;
    
    
}
     
 

#his{
 margin-left:1150px;
  margin-top:-90px;
  color:blue;
  position:fixed;
}
 .panel.panel-default
{
  height: 80%;
  width: 100%;
  border-style: solid;
  border-color: black;
}
#table-wrapper {
  position:relative;
}
#tscroll {
  height:90%;
  overflow:auto;
  margin-top:5%;
}
    

  </style>

 <body  style="background-color:FFE4B5;" ng-controller="stockCntrl" >
 
        
     
        
     <div ng-include="'allInclude.html'"></div>
 <div  class="center" ng-cloak>
  <h3 >Daily Closing Stock</h3>
 
   
  </div> <br>
 <!-- <div class="row"> -->
  <div class="col-sm-6">
For:<input type="date" ng-model="bit1.date2" ng-change="clearCall()">
  
  </div> 
 
  
<div class="col-sm-6">
    <button ng-click="stockVerifyPreview()" class="btn btn-primary" id="save" >Preview</button>
   <!--  <a href='mainpage.html'><button type="button" class="btn btn-danger"   ng-cloak>Close</button></a> -->
    <button class="btn btn-info" id="cmd" ng-disabled="review!='yes'">P D F</button>
    <button class="btn btn-danger" id="btnExport" ng-disabled="review!='yes'">Export</button>

 </div>
 <br>
 <br>
    <br>
 <!-- <div class="container"> -->
  <div class="col-sm-12">
 <div class="panel panel-default" id="target" >
    <div id="table-wrapper">
<!--   <div class="container"> -->
  <table class ="table no-border" >
    <thead>
          <tr  class="panel panel-default">
           <th>Category</th>
          <th>OB Wt</th>
      <th>OB Items</th>
            <th >OB Pcs</th>
              <th>In Wt</th>
               <th>In Items</th>
               <th>In Pcs</th>
              <th>Out Wt</th>
              <th>Out Items</th>
               <th>Out Pcs</th>
          <th>CB Wt</th>
          <th >CB Items</th>
      <th>CB Pcs</th>
           <tr ng-repeat="items in displayReport track by $index"> 
             <td>{{items.SaleCategory}}</td>
             <td>{{items.opgwt | number:3}}</td>
             <td>{{items.opcount | number:0}}</td>
             <td>{{items.opgpcs| number:0}}</td>
             
              <td>{{items.ingwt | number:3}}</td>
             <td>{{items.incount| number:0}}</td>
             <td>{{items.ingpcs | number:0}}</td>
            
             <td>{{items.outgwt | number:3}}</td>
             <td>{{items.outcount | number:0}}</td>
             <td>{{items.outgpcs | number:0}}</td>
             
             <td>{{items.cbgwt | number:3}}</td>
             <td>{{items.cbcount | number:0}}</td>
             <td>{{items.cbgpcs | number:0}}</td>
             
             
           </tr>
            
          </tr>
     </thead>
   </table>
 </div>
</div>


    </div>
 <!--  </div> -->


</body>
      
 <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.0/angular.min.js"></script>
<script type="text/javascript" src="controller/dailyStockClosing.js"></script> 

 </html>
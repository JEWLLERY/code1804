<!DOCTYPE>
<html ng-app="myApp">
<head>
<title>History</title>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.5/jspdf.min.js"></script>
<script type="text/javascript">
    $(document).ready(function(){
        var specialElementHandlers = {
            '#editor': function (element,renderer) {
                return true;
            }
        };
        $('#cmd').click(function () {
            var doc = new jsPDF( "landscape","pt","legal");
            // doc.autoTable(columns, rows);
            var dt = new Date();
    var day = dt.getDate();
    var month = dt.getMonth() + 1;
    var year = dt.getFullYear();
    // var hour = dt.getHours();
    // var mins = dt.getMinutes();
    var postfix = day + "." + month + "." + year;
     // var data_type = 'data:GroupWise.pdf';
            var source = $('#thrid').html();
            var specialElementHandlers = {
                '#bypassme': function (element, renderer) {
                    return true;
                }
                
            };
            doc.fromHTML(source, 0, 0, {
                              width: '100%',
                'elementHandlers': specialElementHandlers
              // }
            });
             doc.save('History-'+postfix+'.pdf');
        });
    });
</script>
<script type="text/javascript">
$(document).ready(function() {
    $("#btnExport").click(function(e) {
        var dt = new Date();
        var day = dt.getDate();
        var month = dt.getMonth() + 1;
        var year = dt.getFullYear();
        // var hour = dt.getHours();
        // var mins = dt.getMinutes();
        var postfix = day + "." + month + "." + year;
        var a = document.createElement('a');
        var data_type = 'data:application/vnd.ms-excel';
        var table_div = document.getElementById('thrid');
        var table_html = table_div.outerHTML.replace(/ /g, '%20');
        a.href = data_type + ', ' + table_html;
        a.download = 'History-' + postfix + '.xls';
        a.click();
        e.preventDefault();
    });
});
</script>
<style>
.center {
    margin:auto;
    width: 10%;
    
    
}
   .selectpic {
   /* margin:auto;*/
    width: 230%;
    
    
}
     
#his{
 margin-left:1150px;
  margin-top:-90px;
  color:blue;
  position:fixed;
}
#main{
	width:1150px;
	height:750px;
	margin-left:100px;
	margin-right:100px;
	border:1px solid black;
}
#second{
	width:1100px;
	height:650px;
	background-color:lightgrey;
	margin-left:25px;
	margin-right:10px;
	margin-top:10px;
}
#thrid{
	width:1050px;
	height:520px;
	background-color:white;
	border:2px solid black;
	margin-left:25px;
	margin-right:20px;
	margin-top:35px;
	overflow-y:auto;
}
#title{
	margin-left:420px;
	margin-top:5px;
	color:black;

}
th,td{
	/*margin-left:10px;*/
	padding-top:-5px;
	padding-left: 20px;
	padding-right: 45px;
}
table {
    border: 1px solid black;
    border-collapse: collapse;
    
}
/*th, td {
    padding: 5px;
}*/
</style>
</head>
<body ng-controller='myctrl1' style="background-color: FFE4B5;">
	<div ng-include="'allInclude.html'"></div>

	<div id='main'>
		<div  id='title'><h2>Party Transaction History</h2></div>
		
		<div id="second" class='row-sm-1'>
			<br>
			<br>
			<label style="margin-left:100px">partyname:</label>
			<!-- <datalist id="partyname"> -->
				<select style='margin-right:15px' ng-model="partyname" >
					<option></option>
					<option ng-repeat="party in partynames">
						{{party.subscriber}}</option>
				</select>&nbsp;&nbsp;&nbsp;&nbsp;
			<!-- </datalist> -->
		
                From: <input type="date" style='margin-right:15px'ng-model="date2">&nbsp;&nbsp;&nbsp;&nbsp;
				 To: <input type="date" ng-model="date1" style='margin-right:15px' >&nbsp;&nbsp;&nbsp;&nbsp;
				 <button style='margin-right:15px' ng-click="getAllDetails(partyname,date2,date1)"  class="btn btn-success" >Preview</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
				 <button style='margin-right:15px' class="btn btn-primary" id="cmd" ng-disabled="isdisabled">PDF</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
				 <button style='margin-right:15px' id="btnExport" class="btn btn-danger" ng-disabled="isdisabled">Export</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			
			
			<div id="thrid">
			<table ng-cloak class="table table-bordered">
				<tr >
					<th >Date</th>
					<th style='margin-right:10px'>Transaction</th>
					<th style='margin-right:10px'>Prefix</th>
					<th style='margin-right:10px'>VoucherNo</th>
					<th style='margin-right:10px'>Suffix</th>
					<th style='margin-right:10px'>Party</th>
					<th style='margin-right:10px'>Value</th>
					<th style='margin-right:10px'>Remarks</th>
				</tr>
				<tr ng-model="alldetails" ng-repeat="party in partydetails">
					<td >{{party.date| date:"dd-MM-y"}}</td>
					<td style='margin-right:10px'>{{party.Transaction}}</td>
					<td style='margin-right:10px'>{{party.Prefix}}</td>
					<td style='margin-right:10px'>{{party.voucherNo}}</td/>
					<td style='margin-right:10px'>{{party.Suffix}}</td>
					<td style='margin-right:10px'>{{party.partyname}}</td>
					<td style='margin-right:10px'>{{party.final}}</td>
					<td style='margin-right:10px'>{{party.Remarks}}</td>
				</tr>
			</table>
			</div>
		</div>
	</div>
</body>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.0/angular.min.js"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/lodash.js/0.10.0/lodash.min.js"></script>

<script type="text/javascript" src="controller/controller.js"></script>
</html>